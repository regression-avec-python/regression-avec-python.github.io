{
  "hash": "961aaf74ff567472795faba157e1f9e8",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"1 RÃ©gression simple\"\ntoc: true\n---\n\n\n\n\n#   La concentration en ozone\n\n::: {#4115aaa6 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport statsmodels.formula.api as smf\n```\n:::\n\n\n\n\n::: {#c9b0cad1 .cell execution_count=3}\n``` {.python .cell-code}\nozone = pd.read_csv(\"../donnees/ozone_simple.txt\", header=0, sep=\";\")\nplt.plot(ozone.T12, ozone.O3, '.k')\nplt.ylabel('O3')\nplt.xlabel('T12')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](chap1_files/figure-html/cell-4-output-1.png){width=577 height=418}\n:::\n:::\n\n\n::: {#b73c6085 .cell execution_count=4}\n``` {.python .cell-code}\nreg = smf.ols('O3 ~ T12', data=ozone).fit()\nreg.summary()\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<table class=\"simpletable\">\n<caption>OLS Regression Results</caption>\n<tr>\n  <th>Dep. Variable:</th>           <td>O3</td>        <th>  R-squared:         </th> <td>   0.279</td>\n</tr>\n<tr>\n  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.264</td>\n</tr>\n<tr>\n  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   18.58</td>\n</tr>\n<tr>\n  <th>Date:</th>             <td>Fri, 31 Jan 2025</td> <th>  Prob (F-statistic):</th> <td>8.04e-05</td>\n</tr>\n<tr>\n  <th>Time:</th>                 <td>15:41:21</td>     <th>  Log-Likelihood:    </th> <td> -220.96</td>\n</tr>\n<tr>\n  <th>No. Observations:</th>      <td>    50</td>      <th>  AIC:               </th> <td>   445.9</td>\n</tr>\n<tr>\n  <th>Df Residuals:</th>          <td>    48</td>      <th>  BIC:               </th> <td>   449.7</td>\n</tr>\n<tr>\n  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   \n</tr>\n<tr>\n  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   \n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n</tr>\n<tr>\n  <th>Intercept</th> <td>   31.4150</td> <td>   13.058</td> <td>    2.406</td> <td> 0.020</td> <td>    5.159</td> <td>   57.671</td>\n</tr>\n<tr>\n  <th>T12</th>       <td>    2.7010</td> <td>    0.627</td> <td>    4.311</td> <td> 0.000</td> <td>    1.441</td> <td>    3.961</td>\n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n  <th>Omnibus:</th>       <td> 2.252</td> <th>  Durbin-Watson:     </th> <td>   1.461</td>\n</tr>\n<tr>\n  <th>Prob(Omnibus):</th> <td> 0.324</td> <th>  Jarque-Bera (JB):  </th> <td>   1.348</td>\n</tr>\n<tr>\n  <th>Skew:</th>          <td> 0.026</td> <th>  Prob(JB):          </th> <td>   0.510</td>\n</tr>\n<tr>\n  <th>Kurtosis:</th>      <td> 2.197</td> <th>  Cond. No.          </th> <td>    94.1</td>\n</tr>\n</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n:::\n:::\n\n\n::: {#361a4f67 .cell execution_count=5}\n``` {.python .cell-code}\ngrille = pd.DataFrame({'T12': np.linspace(ozone.T12.min(), ozone.T12.max(), 100)})\ncalculprev = reg.get_prediction(grille)\nICdte = calculprev.conf_int(obs=False, alpha=0.05)\nprev = calculprev.predicted_mean\nICprev = calculprev.conf_int(obs=True, alpha=0.05)\n```\n:::\n\n\n::: {#9a2cdf5f .cell execution_count=6}\n``` {.python .cell-code}\nplt.plot(ozone.T12, ozone.O3, '.k')\nplt.ylabel('O3')\nplt.xlabel('T12')\nplt.plot(grille.T12,  prev, '-', lw=1, label=\"E(Y)\")\nlesic, = plt.plot(grille.T12, ICdte[:, 0], 'r--', label=r\"IC $\\mathbb{E}(Y)$\", lw=1)\nplt.plot(grille.T12, ICdte[:, 1], 'r--', lw=1)\nplt.legend(handles=[lesic,], loc='lower right')\n```\n\n::: {.cell-output .cell-output-display}\n![](chap1_files/figure-html/cell-7-output-1.png){width=577 height=418}\n:::\n:::\n\n\n::: {#584579c9 .cell execution_count=7}\n``` {.python .cell-code}\nplt.plot(ozone.T12, ozone.O3, '.k')\nplt.ylabel('O3') ; plt.xlabel('T12')\nplt.plot(grille.T12,  prev, '-', lw=1, label=\"E(Y)\")\nlesic, = plt.plot(grille.T12, ICdte[:, 0], 'r--', label=r\"IC $\\mathbb{E}(Y)$\", lw=1)\nplt.plot(grille.T12, ICdte[:, 1],'r--', lw=1)\n\nlesic2, = plt.plot(grille.T12, ICprev[:, 0], 'g:', label=r\"IC $Y$\", lw=1)\nplt.plot(grille.T12, ICprev[:, 1],'g:', lw=1)\nplt.legend(handles=[lesic, lesic2], loc='lower right')\n```\n\n::: {.cell-output .cell-output-display}\n![](chap1_files/figure-html/cell-8-output-1.png){width=577 height=418}\n:::\n:::\n\n\n::: {#8ea90d72 .cell execution_count=8}\n``` {.python .cell-code}\nICparams = reg.conf_int(alpha=0.05)\nround(ICparams, 3)\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Intercept</th>\n      <td>5.159</td>\n      <td>57.671</td>\n    </tr>\n    <tr>\n      <th>T12</th>\n      <td>1.441</td>\n      <td>3.961</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#  La hauteur des eucalyptus\n\n::: {#3cd36850 .cell execution_count=9}\n``` {.python .cell-code}\neucalyptus = pd.read_csv(\"../donnees/eucalyptus.txt\", header=0, sep=\";\")\nplt.plot(eucalyptus.circ, eucalyptus.ht, '+k')\nplt.ylabel('ht')\nplt.xlabel('circ')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](chap1_files/figure-html/cell-10-output-1.png){width=580 height=418}\n:::\n:::\n\n\n::: {#05d00616 .cell execution_count=10}\n``` {.python .cell-code}\nreg = smf.ols('ht ~ circ', data=eucalyptus).fit()\nreg.summary()\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<table class=\"simpletable\">\n<caption>OLS Regression Results</caption>\n<tr>\n  <th>Dep. Variable:</th>           <td>ht</td>        <th>  R-squared:         </th> <td>   0.768</td>\n</tr>\n<tr>\n  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.768</td>\n</tr>\n<tr>\n  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   4732.</td>\n</tr>\n<tr>\n  <th>Date:</th>             <td>Fri, 31 Jan 2025</td> <th>  Prob (F-statistic):</th>  <td>  0.00</td> \n</tr>\n<tr>\n  <th>Time:</th>                 <td>15:41:22</td>     <th>  Log-Likelihood:    </th> <td> -2286.2</td>\n</tr>\n<tr>\n  <th>No. Observations:</th>      <td>  1429</td>      <th>  AIC:               </th> <td>   4576.</td>\n</tr>\n<tr>\n  <th>Df Residuals:</th>          <td>  1427</td>      <th>  BIC:               </th> <td>   4587.</td>\n</tr>\n<tr>\n  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   \n</tr>\n<tr>\n  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   \n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n</tr>\n<tr>\n  <th>Intercept</th> <td>    9.0375</td> <td>    0.180</td> <td>   50.264</td> <td> 0.000</td> <td>    8.685</td> <td>    9.390</td>\n</tr>\n<tr>\n  <th>circ</th>      <td>    0.2571</td> <td>    0.004</td> <td>   68.792</td> <td> 0.000</td> <td>    0.250</td> <td>    0.264</td>\n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n  <th>Omnibus:</th>       <td> 7.943</td> <th>  Durbin-Watson:     </th> <td>   1.067</td>\n</tr>\n<tr>\n  <th>Prob(Omnibus):</th> <td> 0.019</td> <th>  Jarque-Bera (JB):  </th> <td>   8.015</td>\n</tr>\n<tr>\n  <th>Skew:</th>          <td>-0.156</td> <th>  Prob(JB):          </th> <td>  0.0182</td>\n</tr>\n<tr>\n  <th>Kurtosis:</th>      <td> 3.193</td> <th>  Cond. No.          </th> <td>    273.</td>\n</tr>\n</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n:::\n:::\n\n\n::: {#49cba686 .cell execution_count=11}\n``` {.python .cell-code}\ngrille = pd.DataFrame({'circ' : np.linspace(eucalyptus.circ.min(), eucalyptus.circ.max(), 100)})\ncalculprev = reg.get_prediction(grille)\nICdte = calculprev.conf_int(obs=False, alpha=0.05)\nICprev = calculprev.conf_int(obs=True, alpha=0.05)\nprev = calculprev.predicted_mean\n```\n:::\n\n\n::: {#6a45c3c6 .cell execution_count=12}\n``` {.python .cell-code}\nplt.plot(eucalyptus.circ, eucalyptus.ht, '+k')\nplt.ylabel('ht') ; plt.xlabel('circ')\nplt.plot(grille.circ,  prev, '-', label=\"E(Y)\", lw=1)\nlesic, = plt.plot(grille.circ, ICdte[:, 0], 'r--', label=r\"IC $\\mathbb{E}(Y)$\", lw=1)\nplt.plot(grille.circ, ICdte[:, 1], 'r--', lw=1)\nplt.legend(handles=[lesic], loc='lower right')\n```\n\n::: {.cell-output .cell-output-display}\n![](chap1_files/figure-html/cell-13-output-1.png){width=580 height=418}\n:::\n:::\n\n\n::: {#4260e105 .cell execution_count=13}\n``` {.python .cell-code}\nplt.plot(eucalyptus.circ, eucalyptus.ht, '+k')\nplt.ylabel('ht') ; plt.xlabel('circ')\nplt.plot(grille.circ,  prev, '-', label=\"E(Y)\", lw=1)\nlesic, = plt.plot(grille.circ, ICdte[:, 0], 'r--', label=r\"IC $\\mathbb{E}(Y)$\", lw=1)\nplt.plot(grille.circ, ICdte[:, 1], 'r--', lw=1)\nlesic2, = plt.plot(grille.circ, ICprev[:, 0], 'g:', label=r\"IC $Y$\", lw=1)\nplt.plot(grille.circ, ICprev[:, 1],'g:', lw=1)\nplt.legend(handles=[lesic, lesic2], loc='lower right')\n```\n\n::: {.cell-output .cell-output-display}\n![](chap1_files/figure-html/cell-14-output-1.png){width=580 height=418}\n:::\n:::\n\n\n",
    "supporting": [
      "chap1_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}