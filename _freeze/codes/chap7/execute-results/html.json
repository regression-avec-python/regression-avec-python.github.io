{
  "hash": "126584b9a92b07435be374a735c4db4a",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Variables qualitatives : ANCOVA et ANOVA\"\ntoc: true\n---\n\n::: {#34e6a31e .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd; import numpy as np\nimport matplotlib.pyplot as plt\nimport matplotlib.cm as cm\nimport seaborn as sns\nimport statsmodels.api as sm\nimport statsmodels.formula.api as smf\nfrom statsmodels.graphics import regressionplots\nfrom statsmodels.graphics.api import interaction_plot\nimport pandas as pd\n```\n:::\n\n\n::: {#f2118b99 .cell execution_count=2}\n``` {.python .cell-code}\nfig = plt.figure()\neucalypt = pd.read_csv(\"../donnees/eucalyptus.txt\", header = 0, sep = \";\")\neucalypt[\"bloc\"] = eucalypt[\"bloc\"].astype(\"category\")\nsns.scatterplot(data=eucalypt, x=\"circ\", y=\"ht\", hue=\"bloc\",style='bloc')\nfig.tight_layout()\n```\n\n::: {.cell-output .cell-output-display}\n![](chap7_files/figure-html/cell-3-output-1.png){width=661 height=468}\n:::\n:::\n\n\n#   La concentration en ozone\n\n::: {#c6e85668 .cell execution_count=3}\n``` {.python .cell-code}\nozone = pd.read_csv(\"../donnees/ozone.txt\", header = 0, sep = \";\")\nozone[\"vent\"]=ozone[\"vent\"].astype(\"category\")\n\n\nniveau = ozone[\"vent\"].cat.categories\ncc = cm.Set1(range(niveau.size))\nmm = [\"o\",\"*\",\"8\",\"s\"]\nfig, ax = plt.subplots()\nfor i, val in enumerate(niveau):\n    print(val)\n    reg = smf.ols(\"O3 ~ 1 + T12\",data=ozone.loc[ozone[\"vent\"]==val]).fit()\n    plt.scatter(ozone.loc[ozone[\"vent\"]==val,\"T12\"],ozone.loc[ozone[\"vent\"]==val,\"O3\"],\n                color=cc[i],label=val, marker=mm[i])\n    regressionplots.abline_plot(model_results=reg, ax=ax, color=cc[i])\n\nplt.legend()\nfig.tight_layout()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEST\nNORD\nOUEST\nSUD\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](chap7_files/figure-html/cell-4-output-2.png){width=662 height=469}\n:::\n:::\n\n\n::: {#a446a63c .cell execution_count=4}\n``` {.python .cell-code}\nmod1b = smf.ols('O3 ~ -1 + vent + T12:vent', data = ozone).fit()\nmod1b.summary()\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<table class=\"simpletable\">\n<caption>OLS Regression Results</caption>\n<tr>\n  <th>Dep. Variable:</th>           <td>O3</td>        <th>  R-squared:         </th> <td>   0.675</td>\n</tr>\n<tr>\n  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.621</td>\n</tr>\n<tr>\n  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   12.48</td>\n</tr>\n<tr>\n  <th>Date:</th>             <td>Fri, 31 Jan 2025</td> <th>  Prob (F-statistic):</th> <td>1.61e-08</td>\n</tr>\n<tr>\n  <th>Time:</th>                 <td>16:29:15</td>     <th>  Log-Likelihood:    </th> <td> -201.01</td>\n</tr>\n<tr>\n  <th>No. Observations:</th>      <td>    50</td>      <th>  AIC:               </th> <td>   418.0</td>\n</tr>\n<tr>\n  <th>Df Residuals:</th>          <td>    42</td>      <th>  BIC:               </th> <td>   433.3</td>\n</tr>\n<tr>\n  <th>Df Model:</th>              <td>     7</td>      <th>                     </th>     <td> </td>   \n</tr>\n<tr>\n  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   \n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n         <td></td>            <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n</tr>\n<tr>\n  <th>vent[EST]</th>       <td>   45.6090</td> <td>   13.934</td> <td>    3.273</td> <td> 0.002</td> <td>   17.488</td> <td>   73.730</td>\n</tr>\n<tr>\n  <th>vent[NORD]</th>      <td>  106.6345</td> <td>   28.034</td> <td>    3.804</td> <td> 0.000</td> <td>   50.059</td> <td>  163.209</td>\n</tr>\n<tr>\n  <th>vent[OUEST]</th>     <td>   64.6840</td> <td>   24.621</td> <td>    2.627</td> <td> 0.012</td> <td>   14.997</td> <td>  114.371</td>\n</tr>\n<tr>\n  <th>vent[SUD]</th>       <td>  -27.0602</td> <td>   26.539</td> <td>   -1.020</td> <td> 0.314</td> <td>  -80.618</td> <td>   26.498</td>\n</tr>\n<tr>\n  <th>T12:vent[EST]</th>   <td>    2.7480</td> <td>    0.634</td> <td>    4.333</td> <td> 0.000</td> <td>    1.468</td> <td>    4.028</td>\n</tr>\n<tr>\n  <th>T12:vent[NORD]</th>  <td>   -1.6491</td> <td>    1.606</td> <td>   -1.027</td> <td> 0.310</td> <td>   -4.890</td> <td>    1.592</td>\n</tr>\n<tr>\n  <th>T12:vent[OUEST]</th> <td>    0.3407</td> <td>    1.205</td> <td>    0.283</td> <td> 0.779</td> <td>   -2.091</td> <td>    2.772</td>\n</tr>\n<tr>\n  <th>T12:vent[SUD]</th>   <td>    5.3786</td> <td>    1.150</td> <td>    4.678</td> <td> 0.000</td> <td>    3.058</td> <td>    7.699</td>\n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n  <th>Omnibus:</th>       <td> 0.276</td> <th>  Durbin-Watson:     </th> <td>   1.561</td>\n</tr>\n<tr>\n  <th>Prob(Omnibus):</th> <td> 0.871</td> <th>  Jarque-Bera (JB):  </th> <td>   0.465</td>\n</tr>\n<tr>\n  <th>Skew:</th>          <td> 0.007</td> <th>  Prob(JB):          </th> <td>   0.793</td>\n</tr>\n<tr>\n  <th>Kurtosis:</th>      <td> 2.528</td> <th>  Cond. No.          </th> <td>    168.</td>\n</tr>\n</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n:::\n:::\n\n\n::: {#3db06aca .cell execution_count=5}\n``` {.python .cell-code}\nmod1 =smf.ols('O3 ~ vent + T12:vent', data = ozone).fit()\nmod1.summary()\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<table class=\"simpletable\">\n<caption>OLS Regression Results</caption>\n<tr>\n  <th>Dep. Variable:</th>           <td>O3</td>        <th>  R-squared:         </th> <td>   0.675</td>\n</tr>\n<tr>\n  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.621</td>\n</tr>\n<tr>\n  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   12.48</td>\n</tr>\n<tr>\n  <th>Date:</th>             <td>Fri, 31 Jan 2025</td> <th>  Prob (F-statistic):</th> <td>1.61e-08</td>\n</tr>\n<tr>\n  <th>Time:</th>                 <td>16:29:15</td>     <th>  Log-Likelihood:    </th> <td> -201.01</td>\n</tr>\n<tr>\n  <th>No. Observations:</th>      <td>    50</td>      <th>  AIC:               </th> <td>   418.0</td>\n</tr>\n<tr>\n  <th>Df Residuals:</th>          <td>    42</td>      <th>  BIC:               </th> <td>   433.3</td>\n</tr>\n<tr>\n  <th>Df Model:</th>              <td>     7</td>      <th>                     </th>     <td> </td>   \n</tr>\n<tr>\n  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   \n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n         <td></td>            <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n</tr>\n<tr>\n  <th>Intercept</th>       <td>   45.6090</td> <td>   13.934</td> <td>    3.273</td> <td> 0.002</td> <td>   17.488</td> <td>   73.730</td>\n</tr>\n<tr>\n  <th>vent[T.NORD]</th>    <td>   61.0255</td> <td>   31.306</td> <td>    1.949</td> <td> 0.058</td> <td>   -2.153</td> <td>  124.204</td>\n</tr>\n<tr>\n  <th>vent[T.OUEST]</th>   <td>   19.0751</td> <td>   28.290</td> <td>    0.674</td> <td> 0.504</td> <td>  -38.017</td> <td>   76.168</td>\n</tr>\n<tr>\n  <th>vent[T.SUD]</th>     <td>  -72.6691</td> <td>   29.975</td> <td>   -2.424</td> <td> 0.020</td> <td> -133.160</td> <td>  -12.178</td>\n</tr>\n<tr>\n  <th>T12:vent[EST]</th>   <td>    2.7480</td> <td>    0.634</td> <td>    4.333</td> <td> 0.000</td> <td>    1.468</td> <td>    4.028</td>\n</tr>\n<tr>\n  <th>T12:vent[NORD]</th>  <td>   -1.6491</td> <td>    1.606</td> <td>   -1.027</td> <td> 0.310</td> <td>   -4.890</td> <td>    1.592</td>\n</tr>\n<tr>\n  <th>T12:vent[OUEST]</th> <td>    0.3407</td> <td>    1.205</td> <td>    0.283</td> <td> 0.779</td> <td>   -2.091</td> <td>    2.772</td>\n</tr>\n<tr>\n  <th>T12:vent[SUD]</th>   <td>    5.3786</td> <td>    1.150</td> <td>    4.678</td> <td> 0.000</td> <td>    3.058</td> <td>    7.699</td>\n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n  <th>Omnibus:</th>       <td> 0.276</td> <th>  Durbin-Watson:     </th> <td>   1.561</td>\n</tr>\n<tr>\n  <th>Prob(Omnibus):</th> <td> 0.871</td> <th>  Jarque-Bera (JB):  </th> <td>   0.465</td>\n</tr>\n<tr>\n  <th>Skew:</th>          <td> 0.007</td> <th>  Prob(JB):          </th> <td>   0.793</td>\n</tr>\n<tr>\n  <th>Kurtosis:</th>      <td> 2.528</td> <th>  Cond. No.          </th> <td>    223.</td>\n</tr>\n</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n:::\n:::\n\n\n::: {#657f1970 .cell execution_count=6}\n``` {.python .cell-code}\nmod2 = smf.ols('O3 ~ vent + T12', data = ozone).fit()\nmod2b = smf.ols('O3 ~ -1 + vent + T12', data = ozone).fit()\nmod3 = smf.ols('O3 ~ vent:T12', data = ozone).fit()\n\nround(sm.stats.anova_lm(mod2,mod1),3)\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>df_resid</th>\n      <th>ssr</th>\n      <th>df_diff</th>\n      <th>ss_diff</th>\n      <th>F</th>\n      <th>Pr(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>45.0</td>\n      <td>12611.951</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>42.0</td>\n      <td>9087.431</td>\n      <td>3.0</td>\n      <td>3524.521</td>\n      <td>5.43</td>\n      <td>0.003</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#8226d0aa .cell execution_count=7}\n``` {.python .cell-code}\nround(sm.stats.anova_lm(mod3,mod1),3)\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>df_resid</th>\n      <th>ssr</th>\n      <th>df_diff</th>\n      <th>ss_diff</th>\n      <th>F</th>\n      <th>Pr(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>45.0</td>\n      <td>11864.057</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>42.0</td>\n      <td>9087.431</td>\n      <td>3.0</td>\n      <td>2776.626</td>\n      <td>4.278</td>\n      <td>0.01</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#608adc92 .cell execution_count=8}\n``` {.python .cell-code}\ninfl = mod2.get_influence()\nfig = plt.figure()\nplt.plot(mod2.fittedvalues,infl.resid_studentized_external,\".\")\nplt.ylabel('résidus')\nplt.xlabel(r'$\\hat Y$')\nfig.tight_layout()\n```\n\n::: {.cell-output .cell-output-display}\n![](chap7_files/figure-html/cell-9-output-1.png){width=661 height=467}\n:::\n:::\n\n\n::: {#85c082dd .cell execution_count=9}\n``` {.python .cell-code}\nfitted2 = mod2.fittedvalues\nsns.set(style=\"whitegrid\")\nfitted3 = 1/5* abs(fitted2.round(3))\ndfresid = pd.concat([fitted2, pd.Series(infl.resid_studentized_external), ozone[[\"O3\", \"vent\"]]], axis=1)\ndfresid.columns=[\"residus\", \"ajustement\", \"O3\", \"vent\"]\ng = sns.FacetGrid(dfresid, col=\"vent\")\ng = g.map(plt.scatter, \"ajustement\", \"residus\")\nfig.tight_layout()\n```\n\n::: {.cell-output .cell-output-display}\n![](chap7_files/figure-html/cell-10-output-1.png){width=1136 height=272}\n:::\n:::\n\n\n::: {#a3b3cf12 .cell execution_count=10}\n``` {.python .cell-code}\nmod = smf.ols('O3 ~ vent + T12 + T12:vent', data = ozone).fit()\nmod.summary()\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<table class=\"simpletable\">\n<caption>OLS Regression Results</caption>\n<tr>\n  <th>Dep. Variable:</th>           <td>O3</td>        <th>  R-squared:         </th> <td>   0.675</td>\n</tr>\n<tr>\n  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.621</td>\n</tr>\n<tr>\n  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   12.48</td>\n</tr>\n<tr>\n  <th>Date:</th>             <td>Fri, 31 Jan 2025</td> <th>  Prob (F-statistic):</th> <td>1.61e-08</td>\n</tr>\n<tr>\n  <th>Time:</th>                 <td>16:29:16</td>     <th>  Log-Likelihood:    </th> <td> -201.01</td>\n</tr>\n<tr>\n  <th>No. Observations:</th>      <td>    50</td>      <th>  AIC:               </th> <td>   418.0</td>\n</tr>\n<tr>\n  <th>Df Residuals:</th>          <td>    42</td>      <th>  BIC:               </th> <td>   433.3</td>\n</tr>\n<tr>\n  <th>Df Model:</th>              <td>     7</td>      <th>                     </th>     <td> </td>   \n</tr>\n<tr>\n  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   \n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n          <td></td>             <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n</tr>\n<tr>\n  <th>Intercept</th>         <td>   45.6090</td> <td>   13.934</td> <td>    3.273</td> <td> 0.002</td> <td>   17.488</td> <td>   73.730</td>\n</tr>\n<tr>\n  <th>vent[T.NORD]</th>      <td>   61.0255</td> <td>   31.306</td> <td>    1.949</td> <td> 0.058</td> <td>   -2.153</td> <td>  124.204</td>\n</tr>\n<tr>\n  <th>vent[T.OUEST]</th>     <td>   19.0751</td> <td>   28.290</td> <td>    0.674</td> <td> 0.504</td> <td>  -38.017</td> <td>   76.168</td>\n</tr>\n<tr>\n  <th>vent[T.SUD]</th>       <td>  -72.6691</td> <td>   29.975</td> <td>   -2.424</td> <td> 0.020</td> <td> -133.160</td> <td>  -12.178</td>\n</tr>\n<tr>\n  <th>T12</th>               <td>    2.7480</td> <td>    0.634</td> <td>    4.333</td> <td> 0.000</td> <td>    1.468</td> <td>    4.028</td>\n</tr>\n<tr>\n  <th>T12:vent[T.NORD]</th>  <td>   -4.3971</td> <td>    1.726</td> <td>   -2.547</td> <td> 0.015</td> <td>   -7.881</td> <td>   -0.913</td>\n</tr>\n<tr>\n  <th>T12:vent[T.OUEST]</th> <td>   -2.4073</td> <td>    1.361</td> <td>   -1.768</td> <td> 0.084</td> <td>   -5.155</td> <td>    0.340</td>\n</tr>\n<tr>\n  <th>T12:vent[T.SUD]</th>   <td>    2.6306</td> <td>    1.313</td> <td>    2.004</td> <td> 0.052</td> <td>   -0.019</td> <td>    5.280</td>\n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n  <th>Omnibus:</th>       <td> 0.276</td> <th>  Durbin-Watson:     </th> <td>   1.561</td>\n</tr>\n<tr>\n  <th>Prob(Omnibus):</th> <td> 0.871</td> <th>  Jarque-Bera (JB):  </th> <td>   0.465</td>\n</tr>\n<tr>\n  <th>Skew:</th>          <td> 0.007</td> <th>  Prob(JB):          </th> <td>   0.793</td>\n</tr>\n<tr>\n  <th>Kurtosis:</th>      <td> 2.528</td> <th>  Cond. No.          </th> <td>    407.</td>\n</tr>\n</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n:::\n:::\n\n\n#   La hauteur des eucalyptus\n\n::: {#5cb45994 .cell execution_count=11}\n``` {.python .cell-code}\neucalypt = pd.read_csv(\"../donnees/eucalyptus.txt\", header = 0, sep = \";\")\neucalypt[\"bloc\"] = eucalypt[\"bloc\"].astype(\"category\")\nm_complet = smf.ols(\"ht ~ - 1 + bloc + bloc:circ\", data = eucalypt).fit()\nm_pente = smf.ols(\"ht ~  - 1 + bloc + circ\", data = eucalypt).fit()\nm_ordonne = smf.ols(\"ht ~ 1 + bloc:circ\", data = eucalypt).fit()\nsm.stats.anova_lm(m_pente, m_complet)\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>df_resid</th>\n      <th>ssr</th>\n      <th>df_diff</th>\n      <th>ss_diff</th>\n      <th>F</th>\n      <th>Pr(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1425.0</td>\n      <td>2005.895987</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1423.0</td>\n      <td>2005.048468</td>\n      <td>2.0</td>\n      <td>0.847519</td>\n      <td>0.300746</td>\n      <td>0.740313</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#57d7e728 .cell execution_count=12}\n``` {.python .cell-code}\nround(sm.stats.anova_lm(m_ordonne, m_complet),3)\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>df_resid</th>\n      <th>ssr</th>\n      <th>df_diff</th>\n      <th>ss_diff</th>\n      <th>F</th>\n      <th>Pr(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1425.0</td>\n      <td>2009.213</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1423.0</td>\n      <td>2005.048</td>\n      <td>2.0</td>\n      <td>4.165</td>\n      <td>1.478</td>\n      <td>0.228</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#8c668e08 .cell execution_count=13}\n``` {.python .cell-code}\nm_simple = smf.ols(\"ht ~ 1 + circ\", data = eucalypt).fit()\nround(sm.stats.anova_lm(m_simple,m_pente),3)\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>df_resid</th>\n      <th>ssr</th>\n      <th>df_diff</th>\n      <th>ss_diff</th>\n      <th>F</th>\n      <th>Pr(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1427.0</td>\n      <td>2052.084</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1425.0</td>\n      <td>2005.896</td>\n      <td>2.0</td>\n      <td>46.188</td>\n      <td>16.406</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#db24e4ab .cell execution_count=14}\n``` {.python .cell-code}\nplt.rc(\"lines\", markersize=3) #\ninfl = m_pente.get_influence()\nfig = plt.figure()\nplt.plot(m_pente.fittedvalues,infl.resid_studentized_external,\".\")\nplt.ylabel('résidus')\nplt.xlabel(r'$\\hat Y$')\nfig.tight_layout()\n```\n\n::: {.cell-output .cell-output-display}\n![](chap7_files/figure-html/cell-15-output-1.png){width=656 height=462}\n:::\n:::\n\n\n#   ANOVA\n\n::: {#aceab9a1 .cell execution_count=15}\n``` {.python .cell-code}\nniveau = ozone[\"vent\"].cat.categories\nO3_parvent = []\nfor i in range(niveau.size):\n    O3_parvent.append(list(ozone.loc[ozone[\"vent\"]==niveau[i],\"O3\"]))\n    \nfig, ax = plt.subplots(1,1)\nbplot = ax.boxplot(O3_parvent,patch_artist=True,tick_labels=niveau )\nfor patch in bplot[\"boxes\"]:\n     patch.set_facecolor(\"#5875a4\")\n\nfig.tight_layout()\n```\n\n::: {.cell-output .cell-output-display}\n![](chap7_files/figure-html/cell-16-output-1.png){width=657 height=465}\n:::\n:::\n\n\n::: {#7fec3ed8 .cell execution_count=16}\n``` {.python .cell-code}\nmod1 = smf.ols(\"O3~vent-1\",data=ozone).fit()\nmod1.summary()\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n```{=html}\n<table class=\"simpletable\">\n<caption>OLS Regression Results</caption>\n<tr>\n  <th>Dep. Variable:</th>           <td>O3</td>        <th>  R-squared:         </th> <td>   0.352</td>\n</tr>\n<tr>\n  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.310</td>\n</tr>\n<tr>\n  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   8.338</td>\n</tr>\n<tr>\n  <th>Date:</th>             <td>Fri, 31 Jan 2025</td> <th>  Prob (F-statistic):</th> <td>0.000156</td>\n</tr>\n<tr>\n  <th>Time:</th>                 <td>16:29:18</td>     <th>  Log-Likelihood:    </th> <td> -218.28</td>\n</tr>\n<tr>\n  <th>No. Observations:</th>      <td>    50</td>      <th>  AIC:               </th> <td>   444.6</td>\n</tr>\n<tr>\n  <th>Df Residuals:</th>          <td>    46</td>      <th>  BIC:               </th> <td>   452.2</td>\n</tr>\n<tr>\n  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>   \n</tr>\n<tr>\n  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   \n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n</tr>\n<tr>\n  <th>vent[EST]</th>   <td>  103.8500</td> <td>    4.963</td> <td>   20.923</td> <td> 0.000</td> <td>   93.859</td> <td>  113.841</td>\n</tr>\n<tr>\n  <th>vent[NORD]</th>  <td>   78.2889</td> <td>    6.618</td> <td>   11.830</td> <td> 0.000</td> <td>   64.968</td> <td>   91.610</td>\n</tr>\n<tr>\n  <th>vent[OUEST]</th> <td>   71.5778</td> <td>    4.680</td> <td>   15.296</td> <td> 0.000</td> <td>   62.158</td> <td>   80.997</td>\n</tr>\n<tr>\n  <th>vent[SUD]</th>   <td>   94.3429</td> <td>    7.504</td> <td>   12.572</td> <td> 0.000</td> <td>   79.238</td> <td>  109.447</td>\n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n  <th>Omnibus:</th>       <td> 1.682</td> <th>  Durbin-Watson:     </th> <td>   1.737</td>\n</tr>\n<tr>\n  <th>Prob(Omnibus):</th> <td> 0.431</td> <th>  Jarque-Bera (JB):  </th> <td>   1.184</td>\n</tr>\n<tr>\n  <th>Skew:</th>          <td> 0.083</td> <th>  Prob(JB):          </th> <td>   0.553</td>\n</tr>\n<tr>\n  <th>Kurtosis:</th>      <td> 2.264</td> <th>  Cond. No.          </th> <td>    1.60</td>\n</tr>\n</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n:::\n:::\n\n\n::: {#1be72f25 .cell execution_count=17}\n``` {.python .cell-code}\nround(sm.stats.anova_lm(mod1),3)\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>df</th>\n      <th>sum_sq</th>\n      <th>mean_sq</th>\n      <th>F</th>\n      <th>PR(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>vent</th>\n      <td>4.0</td>\n      <td>382244.343</td>\n      <td>95561.086</td>\n      <td>242.442</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>Residual</th>\n      <td>46.0</td>\n      <td>18131.377</td>\n      <td>394.160</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#d565b2b7 .cell execution_count=18}\n``` {.python .cell-code}\nmod2 = smf.ols(\"O3 ~ vent\", data = ozone).fit()\nmod2.summary()\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n```{=html}\n<table class=\"simpletable\">\n<caption>OLS Regression Results</caption>\n<tr>\n  <th>Dep. Variable:</th>           <td>O3</td>        <th>  R-squared:         </th> <td>   0.352</td>\n</tr>\n<tr>\n  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.310</td>\n</tr>\n<tr>\n  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   8.338</td>\n</tr>\n<tr>\n  <th>Date:</th>             <td>Fri, 31 Jan 2025</td> <th>  Prob (F-statistic):</th> <td>0.000156</td>\n</tr>\n<tr>\n  <th>Time:</th>                 <td>16:29:18</td>     <th>  Log-Likelihood:    </th> <td> -218.28</td>\n</tr>\n<tr>\n  <th>No. Observations:</th>      <td>    50</td>      <th>  AIC:               </th> <td>   444.6</td>\n</tr>\n<tr>\n  <th>Df Residuals:</th>          <td>    46</td>      <th>  BIC:               </th> <td>   452.2</td>\n</tr>\n<tr>\n  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>   \n</tr>\n<tr>\n  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   \n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n        <td></td>           <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n</tr>\n<tr>\n  <th>Intercept</th>     <td>  103.8500</td> <td>    4.963</td> <td>   20.923</td> <td> 0.000</td> <td>   93.859</td> <td>  113.841</td>\n</tr>\n<tr>\n  <th>vent[T.NORD]</th>  <td>  -25.5611</td> <td>    8.272</td> <td>   -3.090</td> <td> 0.003</td> <td>  -42.212</td> <td>   -8.910</td>\n</tr>\n<tr>\n  <th>vent[T.OUEST]</th> <td>  -32.2722</td> <td>    6.821</td> <td>   -4.731</td> <td> 0.000</td> <td>  -46.003</td> <td>  -18.541</td>\n</tr>\n<tr>\n  <th>vent[T.SUD]</th>   <td>   -9.5071</td> <td>    8.997</td> <td>   -1.057</td> <td> 0.296</td> <td>  -27.617</td> <td>    8.603</td>\n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n  <th>Omnibus:</th>       <td> 1.682</td> <th>  Durbin-Watson:     </th> <td>   1.737</td>\n</tr>\n<tr>\n  <th>Prob(Omnibus):</th> <td> 0.431</td> <th>  Jarque-Bera (JB):  </th> <td>   1.184</td>\n</tr>\n<tr>\n  <th>Skew:</th>          <td> 0.083</td> <th>  Prob(JB):          </th> <td>   0.553</td>\n</tr>\n<tr>\n  <th>Kurtosis:</th>      <td> 2.264</td> <th>  Cond. No.          </th> <td>    4.51</td>\n</tr>\n</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n:::\n:::\n\n\n::: {#9ea5c3b9 .cell execution_count=19}\n``` {.python .cell-code}\nround(sm.stats.anova_lm(mod2),3)\n```\n\n::: {.cell-output .cell-output-display execution_count=19}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>df</th>\n      <th>sum_sq</th>\n      <th>mean_sq</th>\n      <th>F</th>\n      <th>PR(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>vent</th>\n      <td>3.0</td>\n      <td>9859.843</td>\n      <td>3286.614</td>\n      <td>8.338</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>Residual</th>\n      <td>46.0</td>\n      <td>18131.377</td>\n      <td>394.160</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#b3e3d59d .cell execution_count=20}\n``` {.python .cell-code}\nsmf.ols(\"O3 ~ C(vent,Treatment)\", data = ozone).fit().params\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```\nIntercept                      103.850000\nC(vent, Treatment)[T.NORD]     -25.561111\nC(vent, Treatment)[T.OUEST]    -32.272222\nC(vent, Treatment)[T.SUD]       -9.507143\ndtype: float64\n```\n:::\n:::\n\n\n::: {#f57ab024 .cell execution_count=21}\n``` {.python .cell-code}\nsmf.ols(\"O3 ~ C(vent, levels=['NORD', 'EST', 'OUEST', 'SUD'])\", \\\n    data = ozone).fit().params\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n```\nIntercept                                                   78.288889\nC(vent, levels=['NORD', 'EST', 'OUEST', 'SUD'])[T.EST]      25.561111\nC(vent, levels=['NORD', 'EST', 'OUEST', 'SUD'])[T.OUEST]    -6.711111\nC(vent, levels=['NORD', 'EST', 'OUEST', 'SUD'])[T.SUD]      16.053968\ndtype: float64\n```\n:::\n:::\n\n\n::: {#43ffd6c0 .cell execution_count=22}\n``` {.python .cell-code}\nfrom patsy import dmatrix, ContrastMatrix\nII = ozone[\"vent\"].cat.categories.size\nnI = ozone[\"vent\"].value_counts()[ozone[\"vent\"].cat.categories]\ncontr_mat = np.vstack([np.eye(II-1), (-nI[:(II-1)]).divide(nI[-1])])\ncontraste = ContrastMatrix(contr_mat, [\"[a1]\", \"[a2]\", \"[a3]\"])\nmod3 = smf.ols(\"O3 ~ 1 + C(vent,contraste)\",data=ozone).fit()\nmod3.summary()\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```{=html}\n<table class=\"simpletable\">\n<caption>OLS Regression Results</caption>\n<tr>\n  <th>Dep. Variable:</th>           <td>O3</td>        <th>  R-squared:         </th> <td>   0.352</td>\n</tr>\n<tr>\n  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.310</td>\n</tr>\n<tr>\n  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   8.338</td>\n</tr>\n<tr>\n  <th>Date:</th>             <td>Fri, 31 Jan 2025</td> <th>  Prob (F-statistic):</th> <td>0.000156</td>\n</tr>\n<tr>\n  <th>Time:</th>                 <td>16:29:18</td>     <th>  Log-Likelihood:    </th> <td> -218.28</td>\n</tr>\n<tr>\n  <th>No. Observations:</th>      <td>    50</td>      <th>  AIC:               </th> <td>   444.6</td>\n</tr>\n<tr>\n  <th>Df Residuals:</th>          <td>    46</td>      <th>  BIC:               </th> <td>   452.2</td>\n</tr>\n<tr>\n  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>   \n</tr>\n<tr>\n  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   \n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n             <td></td>               <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n</tr>\n<tr>\n  <th>Intercept</th>              <td>   86.3000</td> <td>    2.808</td> <td>   30.737</td> <td> 0.000</td> <td>   80.648</td> <td>   91.952</td>\n</tr>\n<tr>\n  <th>C(vent, contraste)[a1]</th> <td>   17.5500</td> <td>    4.093</td> <td>    4.288</td> <td> 0.000</td> <td>    9.311</td> <td>   25.789</td>\n</tr>\n<tr>\n  <th>C(vent, contraste)[a2]</th> <td>   -8.0111</td> <td>    5.993</td> <td>   -1.337</td> <td> 0.188</td> <td>  -20.074</td> <td>    4.052</td>\n</tr>\n<tr>\n  <th>C(vent, contraste)[a3]</th> <td>  -14.7222</td> <td>    3.744</td> <td>   -3.933</td> <td> 0.000</td> <td>  -22.258</td> <td>   -7.187</td>\n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n  <th>Omnibus:</th>       <td> 1.682</td> <th>  Durbin-Watson:     </th> <td>   1.737</td>\n</tr>\n<tr>\n  <th>Prob(Omnibus):</th> <td> 0.431</td> <th>  Jarque-Bera (JB):  </th> <td>   1.184</td>\n</tr>\n<tr>\n  <th>Skew:</th>          <td> 0.083</td> <th>  Prob(JB):          </th> <td>   0.553</td>\n</tr>\n<tr>\n  <th>Kurtosis:</th>      <td> 2.264</td> <th>  Cond. No.          </th> <td>    3.34</td>\n</tr>\n</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n:::\n:::\n\n\n::: {#d5515230 .cell execution_count=23}\n``` {.python .cell-code}\nround(sm.stats.anova_lm(mod3),3)\n```\n\n::: {.cell-output .cell-output-display execution_count=23}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>df</th>\n      <th>sum_sq</th>\n      <th>mean_sq</th>\n      <th>F</th>\n      <th>PR(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>C(vent, contraste)</th>\n      <td>3.0</td>\n      <td>9859.843</td>\n      <td>3286.614</td>\n      <td>8.338</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>Residual</th>\n      <td>46.0</td>\n      <td>18131.377</td>\n      <td>394.160</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#045d7fcf .cell execution_count=24}\n``` {.python .cell-code}\nmod4 = smf.ols(\"O3 ~ 1+ C(vent,Sum)\", data = ozone).fit()\nround(sm.stats.anova_lm(mod4),3)\n```\n\n::: {.cell-output .cell-output-display execution_count=24}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>df</th>\n      <th>sum_sq</th>\n      <th>mean_sq</th>\n      <th>F</th>\n      <th>PR(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>C(vent, Sum)</th>\n      <td>3.0</td>\n      <td>9859.843</td>\n      <td>3286.614</td>\n      <td>8.338</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>Residual</th>\n      <td>46.0</td>\n      <td>18131.377</td>\n      <td>394.160</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#7b78296e .cell execution_count=25}\n``` {.python .cell-code}\nprint(ozone)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        Date     O3   T12   T15  Ne12  N12  S12  E12  W12     Vx    O3v  \\\n0   19960422   63.6  13.4  15.0     7    0    0    3    0   9.35   95.6   \n1   19960429   89.6  15.0  15.7     4    3    0    0    0   5.40  100.2   \n2   19960506   79.0   7.9  10.1     8    0    0    7    0  19.30  105.6   \n3   19960514   81.2  13.1  11.7     7    7    0    0    0  12.60   95.2   \n4   19960521   88.0  14.1  16.0     6    0    0    0    6 -20.30   82.8   \n5   19960528   68.4  16.7  18.1     7    0    3    0    0  -3.69   71.4   \n6   19960605  139.0  26.8  28.2     1    0    0    3    0   8.27   90.0   \n7   19960612   78.2  18.4  20.7     7    4    0    0    0   4.93   60.0   \n8   19960619  113.8  27.2  27.7     6    0    4    0    0  -4.93  125.8   \n9   19960627   41.8  20.6  19.7     8    0    0    0    1  -3.38   62.6   \n10  19960704   65.0  21.0  21.1     6    0    0    0    7 -23.68   38.0   \n11  19960711   73.0  17.4  22.8     8    0    0    0    2  -6.24   70.8   \n12  19960719  126.2  26.9  29.5     2    0    0    4    0  14.18  119.8   \n13  19960726  127.8  25.5  27.8     3    0    0    5    0  13.79  103.6   \n14  19960802   61.6  19.4  21.5     7    6    0    0    0  -7.39   69.2   \n15  19960810   63.6  20.8  21.4     7    0    0    0    5 -13.79   48.0   \n16  19960817  134.2  29.5  30.6     2    0    3    0    0   1.88  118.6   \n17  19960824   67.2  21.7  20.3     7    0    0    0    7 -24.82   60.0   \n18  19960901   87.8  19.7  21.7     5    0    0    3    0   9.35   74.4   \n19  19960908   96.8  19.0  21.0     6    0    0    8    0  28.36  103.8   \n20  19960915   89.6  20.7  22.9     1    0    0    4    0  12.47   78.8   \n21  19960923   66.4  18.0  18.5     7    0    0    0    2  -5.52   72.2   \n22  19960930   60.0  17.4  16.4     8    0    6    0    0 -10.80   53.4   \n23  19970414   90.8  16.3  18.1     0    0    0    5    0  18.00   89.0   \n24  19970422  104.2  13.6  14.4     1    0    0    1    0   3.55   97.8   \n25  19970429   70.0  15.8  16.7     7    7    0    0    0 -12.60   61.4   \n26  19970708   96.2  26.0  27.3     2    0    0    5    0  16.91   87.4   \n27  19970715   65.6  23.5  23.7     7    0    0    0    3  -9.35   67.8   \n28  19970722  109.2  26.3  27.3     4    0    0    5    0  16.91   98.6   \n29  19970730   86.2  21.8  23.6     6    4    0    0    0   2.50  112.0   \n30  19970806   87.4  24.8  26.6     3    0    0    0    2  -7.09   49.8   \n31  19970813   84.0  25.2  27.5     3    0    0    0    3 -10.15  131.8   \n32  19970821   83.0  24.6  27.9     3    0    0    0    2  -5.52  113.8   \n33  19970828   59.6  16.8  19.0     7    0    0    0    8 -27.06   55.8   \n34  19970904   52.0  17.1  18.3     8    5    0    0    0  -3.13   65.8   \n35  19970912   73.8  18.0  18.3     7    0    5    0    0 -11.57   90.4   \n36  19970919  129.0  28.9  30.0     1    0    0    3    0   8.27  111.4   \n37  19970926  122.4  23.4  25.4     0    0    0    2    0   5.52  118.6   \n38  19980504  106.6  13.0  14.3     3    7    0    0    0  12.60   84.0   \n39  19980511  121.8  26.0  28.0     2    0    4    0    0   2.50  109.8   \n40  19980518  116.2  24.9  25.8     2    0    0    5    0  18.00  142.8   \n41  19980526   81.4  18.4  16.8     7    0    0    0    4 -14.40   80.8   \n42  19980602   88.6  18.7  19.6     5    0    0    0    5 -15.59   60.4   \n43  19980609   63.0  20.4  16.6     7    0    0    0    8 -22.06   79.8   \n44  19980617  104.0  19.6  21.2     6    0    0    0    3 -10.80   84.6   \n45  19980624   88.4  23.2  23.9     4    0    4    0    0  -7.20   92.6   \n46  19980701   83.8  19.8  20.3     8    0    0    5    0  17.73   40.2   \n47  19980709   56.4  18.9  19.3     8    0    0    0    4 -14.40   73.6   \n48  19980716   50.4  19.7  19.3     7    0    0    0    5 -17.73   59.0   \n49  19980724   79.2  21.1  21.9     3    4    0    0    0   9.26   55.2   \n\n      nebu   vent  \n0    NUAGE    EST  \n1   SOLEIL   NORD  \n2    NUAGE    EST  \n3    NUAGE   NORD  \n4    NUAGE  OUEST  \n5    NUAGE    SUD  \n6   SOLEIL    EST  \n7    NUAGE   NORD  \n8    NUAGE    SUD  \n9    NUAGE  OUEST  \n10   NUAGE  OUEST  \n11   NUAGE  OUEST  \n12  SOLEIL    EST  \n13  SOLEIL    EST  \n14   NUAGE   NORD  \n15   NUAGE  OUEST  \n16  SOLEIL    SUD  \n17   NUAGE  OUEST  \n18  SOLEIL    EST  \n19   NUAGE    EST  \n20  SOLEIL    EST  \n21   NUAGE  OUEST  \n22   NUAGE    SUD  \n23  SOLEIL    EST  \n24  SOLEIL    EST  \n25   NUAGE   NORD  \n26  SOLEIL    EST  \n27   NUAGE  OUEST  \n28  SOLEIL    EST  \n29   NUAGE   NORD  \n30  SOLEIL  OUEST  \n31  SOLEIL  OUEST  \n32  SOLEIL  OUEST  \n33   NUAGE  OUEST  \n34   NUAGE   NORD  \n35   NUAGE    SUD  \n36  SOLEIL    EST  \n37  SOLEIL    EST  \n38  SOLEIL   NORD  \n39  SOLEIL    SUD  \n40  SOLEIL    EST  \n41   NUAGE  OUEST  \n42  SOLEIL  OUEST  \n43   NUAGE  OUEST  \n44   NUAGE  OUEST  \n45  SOLEIL    SUD  \n46   NUAGE    EST  \n47   NUAGE  OUEST  \n48   NUAGE  OUEST  \n49  SOLEIL   NORD  \n```\n:::\n:::\n\n\n::: {#1311a7d5 .cell execution_count=26}\n``` {.python .cell-code}\nozone = pd.read_csv(\"../donnees/ozone.txt\", header = 0, sep = \";\")\nozone[\"vent\"]=ozone[\"vent\"].astype(\"category\")\nozone[\"nebu\"]=ozone[\"nebu\"].astype(\"category\")\nplt.rcParams['font.size'] = '7'\nfrom statsmodels.graphics.api import interaction_plot\ncc2 = cm.Set1(range(ozone[\"vent\"].cat.categories.size))\nfig, axs = plt.subplots(1,2)\nplt.rcParams['font.size'] = '4'\ninteraction_plot(ozone[\"vent\"].astype(\"str\"), ozone[\"nebu\"].astype(\"str\"), ozone[\"O3\"], colors=cc2[:2], markers=['^','D'],ax=axs[0])\ninteraction_plot( ozone[\"nebu\"].astype(\"str\"), ozone[\"vent\"].astype(\"str\"),ozone[\"O3\"], colors=cc2, markers=['^','D',\"*\",\"8\"],ax=axs[1])\nfig.tight_layout()\n```\n\n::: {.cell-output .cell-output-display}\n![](chap7_files/figure-html/cell-27-output-1.png){width=677 height=487}\n:::\n:::\n\n\n::: {#00faeb19 .cell execution_count=27}\n``` {.python .cell-code}\nmod1 = smf.ols(\"O3 ~ vent + nebu + vent:nebu\", data = ozone).fit()\nmod2 = smf.ols(\"O3 ~ vent + nebu \", data = ozone).fit()\nsm.stats.anova_lm(mod2,mod1)\n```\n\n::: {.cell-output .cell-output-display execution_count=27}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>df_resid</th>\n      <th>ssr</th>\n      <th>df_diff</th>\n      <th>ss_diff</th>\n      <th>F</th>\n      <th>Pr(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>45.0</td>\n      <td>11729.859077</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>42.0</td>\n      <td>11246.238571</td>\n      <td>3.0</td>\n      <td>483.620506</td>\n      <td>0.60204</td>\n      <td>0.617302</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#dc6927ca .cell execution_count=28}\n``` {.python .cell-code}\nmod3 = smf.ols(\"O3 ~ vent\", data = ozone).fit()\nround(sm.stats.anova_lm(mod3,mod2),3)\n```\n\n::: {.cell-output .cell-output-display execution_count=28}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>df_resid</th>\n      <th>ssr</th>\n      <th>df_diff</th>\n      <th>ss_diff</th>\n      <th>F</th>\n      <th>Pr(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>46.0</td>\n      <td>18131.377</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>45.0</td>\n      <td>11729.859</td>\n      <td>1.0</td>\n      <td>6401.518</td>\n      <td>24.559</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#b8fee24b .cell execution_count=29}\n``` {.python .cell-code}\nround(sm.stats.anova_lm(mod3, mod2, mod1),3)\n```\n\n::: {.cell-output .cell-output-display execution_count=29}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>df_resid</th>\n      <th>ssr</th>\n      <th>df_diff</th>\n      <th>ss_diff</th>\n      <th>F</th>\n      <th>Pr(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>46.0</td>\n      <td>18131.377</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>45.0</td>\n      <td>11729.859</td>\n      <td>1.0</td>\n      <td>6401.518</td>\n      <td>23.907</td>\n      <td>0.000</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>42.0</td>\n      <td>11246.239</td>\n      <td>3.0</td>\n      <td>483.621</td>\n      <td>0.602</td>\n      <td>0.617</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#a3915a67 .cell execution_count=30}\n``` {.python .cell-code}\nround(sm.stats.anova_lm(mod1),3)\n```\n\n::: {.cell-output .cell-output-display execution_count=30}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>df</th>\n      <th>sum_sq</th>\n      <th>mean_sq</th>\n      <th>F</th>\n      <th>PR(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>vent</th>\n      <td>3.0</td>\n      <td>9859.843</td>\n      <td>3286.614</td>\n      <td>12.274</td>\n      <td>0.000</td>\n    </tr>\n    <tr>\n      <th>nebu</th>\n      <td>1.0</td>\n      <td>6401.518</td>\n      <td>6401.518</td>\n      <td>23.907</td>\n      <td>0.000</td>\n    </tr>\n    <tr>\n      <th>vent:nebu</th>\n      <td>3.0</td>\n      <td>483.621</td>\n      <td>161.207</td>\n      <td>0.602</td>\n      <td>0.617</td>\n    </tr>\n    <tr>\n      <th>Residual</th>\n      <td>42.0</td>\n      <td>11246.239</td>\n      <td>267.768</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "chap7_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}